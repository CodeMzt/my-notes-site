# 传统计算机视觉

# 图像和像素

在深入学习复杂的算法之前，我们必须先了解计算机视觉处理的**对象**：**数字图像**。
## 1. 数字图像

对于计算机而言，图像不是我们肉眼看到的连续的画面，而是由**有限数量的元素**组成的二维矩阵，这些元素被称为**像素 (Pixel)**。

- **二维矩阵：** 图像可以被看作是一个巨大的表格，有行（高度）和列（宽度）。
    
- **像素 (Pixel)：** 矩阵中的每一个“格子”就是一个像素点，它是图像的最小单位。每个像素点存储了该位置的**颜色信息**或**灰度信息**。
## 2. 图像的类型

在传统CV中，我们最常处理以下两种图像类型：
### A. 灰度图像 (Grayscale Image)

- **组成：** 每个像素只包含一个数值，通常在 **0 到 255** 之间。
    
- **含义：** 这个数值代表该点的**亮度**（或称灰度）。
    
    - **0** 表示 **纯黑色** (Black)
        
    - **255** 表示 **纯白色** (White)
        
    - **中间值** 表示不同程度的**灰色**。
        
- **存储：** 只需要一个二维矩阵（$H \times W$）。
    
### B. 彩色图像 (Color Image)

- **组成：** 每个像素包含**三个**独立的数值，分别代表**红 (Red)**、**绿 (Green)**、**蓝 (Blue)** 三种颜色分量，简称 **RGB**。
    
- **含义：** 这三个数值（通常也是 0-255）组合起来，就能表示出自然界中的几乎所有颜色。
    
    - 例如，(255, 0, 0) 是纯红色；(0, 0, 0) 是黑色；(255, 255, 255) 是白色。
        
- **存储：** 需要一个三维矩阵（$H \times W \times 3$），其中 3 就是指 R、G、B 这三个**通道 (Channel)**
## 3. 图像预处理的起点：操作像素

明白了图像就是数字矩阵后，传统CV的第一步——**图像预处理**，就变得容易理解了。许多预处理操作本质上都是对这些像素值进行数学运算。

### 基础操作示例：

- **图像反转 (Image Inversion)：** 将亮的地方变暗，暗的地方变亮。
    
    - 对于一个灰度图像的像素值 $P$，其反转后的像素值 $P'$ 为：
        
        $$P' = 255 - P$$
        
    - 比如，亮度为 10 的黑点 (接近黑) 变成 245 (接近白)，亮度为 200 的灰点变成 55。
        
- **图像缩放 (Scaling)：** 改变图像的尺寸，这涉及到插值计算，即根据周围像素的值来估计新位置像素的值。
- **类型转化** ：绿光敏感
$$P_{\text{灰度}} = 0.299 \times R + 0.587 \times G + 0.114 \times B$$
# 直方图与点运算
## 1. 图像直方图 (Image Histogram)

直方图是计算机视觉中最基本、最重要的一种**统计工具**。
### A. 直方图

对于一个灰度图像（像素值范围 $0 \sim 255$），直方图是一个**柱状图**，它统计了图像中**每个灰度级出现的频率或次数**。

- **横轴 (X 轴)：** 表示灰度级（从 0 到 255）。
    
- **纵轴 (Y 轴)：** 表示该灰度级对应的**像素数量**。
	
### B. 直方图的意义

通过观察直方图，我们可以快速了解图像的整体特性：

|**直方图特征**|**图像表现**|**调整需求**|
|---|---|---|
|**集中在低灰度区 (0 附近)**|图像整体**偏暗**，缺乏高亮细节。|需要**提高亮度**。|
|**集中在高灰度区 (255 附近)**|图像整体**偏亮**或**曝光过度**。|可能需要**降低亮度**。|
|**分布集中在一个窄小的区域**|**对比度低**，画面“灰蒙蒙”的，细节不清晰。|需要**增强对比度**。|
|**分布均匀，覆盖整个 0~255 范围**|**对比度高**，细节丰富，视觉效果好。|理想的图像。|

直方图是很多高级图像处理算法（比如图像分割、阈值处理）的基础。

---

## 2. 点运算 (Point Operations)

点运算，顾名思义，是只根据**输入图像中一个点的像素值**，来决定**输出图像中对应点的像素值**的运算。它不考虑周围像素的值。

### A. 亮度调整 (Brightness Adjustment)

这是最简单的点运算，通过对所有像素值统一进行加法或减法实现。

- 设输入像素值为 $P_{\text{in}}$，输出像素值为 $P_{\text{out}}$，调节量为 $b$：
    $$P_{\text{out}} = P_{\text{in}} + b$$
    
- **当 $b > 0$ 时：** 图像变亮。
    
- **当 $b < 0$ 时：** 图像变暗。
    
- **注意：** 运算结果必须进行**截断 (Clipping)**，确保 $0 \le P_{\text{out}} \le 255$。例如，如果 $P_{\text{in}} = 240$，$b = 30$，那么 $P_{\text{out}}$ 应该是 255，而不是 270。
    
### B. 对比度调整 (Contrast Adjustment)

通过对像素值进行乘法运算来增强或减弱对比度。

- 设调节因子为 $\alpha$ ($\alpha > 0$)：
    $$P_{\text{out}} = \alpha \times P_{\text{in}}$$
    
- **当 $\alpha > 1$ 时：** 像素值之间的差距被放大，**对比度增强**。
    
- **当 $\alpha < 1$ 时：** 像素值之间的差距被缩小，**对比度减弱**。
    
- 同样需要进行 $0 \sim 255$ 的截断处理。
    
### C. 直方图均衡化 (Histogram Equalization)

直方图均衡化是一种**自动增强对比度**的技术。

- **目的：** 自动找到一个变换函数，将图像的原始直方图**拉伸**并使其尽量**均匀**地分布在整个 $0 \sim 255$ 灰度范围内。
    
- **效果：** 它可以显著地增强那些原来对比度较低的图像的细节，特别是在医学图像处理和旧照片增强中非常有用。

# 邻域运算与图像滤波（Image Filtering）

邻域运算是传统计算机视觉的核心，它允许我们利用像素周围的信息来计算和修改当前像素的值。

## 1. 邻域运算

邻域运算（或称区域运算）的核心思想是：**输出图像中一个像素的值，取决于输入图像中该像素及其周围邻近像素的值。**（不会改变大小）

这个“周围邻近像素”的区域，我们称之为**邻域 (Neighborhood)**。

- **实现工具：** 我们使用一个小的矩阵，称为**核 (Kernel)**、**滤波器 (Filter)** 或**模板 (Mask)**，在整个图像上**滑动**，并进行**卷积 (Convolution)** 运算。
    
## 2. 图像滤波 (Image Filtering)

图像滤波是邻域运算最常见的应用。它的主要目的是：**突出图像的某些特征或抑制图像中的噪声。**

根据处理效果，图像滤波可以分为两大类：**平滑滤波**（去噪、模糊）和**锐化滤波**（突出边缘、细节）。

---

## 3. 平滑滤波 (Smoothing Filters)

平滑滤波主要用于**降噪**（去除图像中的随机噪声）和**模糊**。

### A. 均值滤波 (Mean Filter / Box Filter)

- **核：** 一个所有元素值都相等的矩阵（如 3x3 矩阵，每个元素是 $1/9$）。
    
- **原理：** 用邻域内所有像素值的**平均值**来替代中心像素的值。
    
- **效果：**
    
    - **优点：** 简单高效，能有效去除高斯（随机）噪声。
        
    - **缺点：** 会导致图像**细节模糊**，特别是边缘信息丢失严重。
        

### B. 高斯滤波 (Gaussian Filter)

- **核：** 权重不是平均分配的，而是根据**高斯分布**（钟形曲线）计算得出的。**距离中心像素越近的像素，权重越大。**
    
- **原理：** 是一种加权平均，它比均值滤波更自然、平滑。
    
- **效果：**
    
    - **优点：** 降噪效果好，同时相比均值滤波，它对图像的模糊效应更柔和、更符合视觉习惯。它是实现图像尺度空间（Scale-Space）表示的基础。
        
### C. 中值滤波 (Median Filter)

- **核：** 同样关注一个邻域窗口（如 3x3）。
    
- **原理：** **不计算平均值**，而是将邻域内的所有像素值进行**排序**，然后用**中间值**来替代中心像素的值。
    
- **效果：**
    
    - **优点：** 对**椒盐噪声 (Salt-and-Pepper Noise)**（即图像中随机出现的黑白点）具有**极强的抑制能力**，因为它会直接“忽略”掉极端值。
        
    - **缺点：** 可能会在平坦区域产生一些失真。
        
    - **特别强调：** 中值滤波是**非线性滤波**的一种，它在去噪的同时能更好地**保留图像的边缘**，因为它不会对边缘处的急剧变化进行平均化处理。
        
---

## 4. 锐化滤波 (Sharpening Filters)

锐化滤波主要用于**增强图像的边缘和细节**。

- **原理：** 锐化操作通常通过**微分**（或**梯度**）来实现。在离散图像中，微分是用**差分**来近似的。图像变化剧烈的地方（即边缘）差分值大；变化平坦的地方（即区域内部）差分值小。
    
- **拉普拉斯算子 (Laplacian Operator)：**
    
    - 这是一个非常著名的二阶微分算子，常用于边缘检测和锐化。
        
    - 核示例 (3x3)：
        
        $$\begin{bmatrix} 0 & 1 & 0 \\ 1 & -4 & 1 \\ 0 & 1 & 0 \end{bmatrix} \quad \text{或} \quad \begin{bmatrix} 1 & 1 & 1 \\ 1 & -8 & 1 \\ 1 & 1 & 1 \end{bmatrix}$$
        
- **效果：** 计算结果的绝对值越大，表示该点越可能是边缘点。通过将拉普拉斯结果与原图叠加，可以实现锐化。