<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>ADC - 个人技术与学习笔记</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "ADC";
        var mkdocs_page_input_path = "\u7535\u8d5b\u8f6f\u4ef6/STM32 HAL\u5e93/ADC.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> 个人技术与学习笔记
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">首页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">机器学习 (Machine Learning)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Pytorch 学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/nn/">nn 神经网络</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/tensor/">Tensor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/data/">data 数据处理</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/transfrom/">transform</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/tensorboard/">tensorboard 可视化</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Pytorch_Learning/Test/">Test Notebook</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">电赛软件 (Embedded Software)</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../%E7%94%B5%E8%B5%9B%E8%BD%AF%E4%BB%B6/">简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ARM 架构</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../ARM%E6%9E%B6%E6%9E%84/ARM%E6%9E%B6%E6%9E%84/">ARM 架构概述</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ARM%E6%9E%B6%E6%9E%84/ARM%20Cortex-M%20CPU%20%E6%9E%B6%E6%9E%84/">ARM Cortex-M CPU 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ARM%E6%9E%B6%E6%9E%84/%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8/">通用寄存器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ARM%E6%9E%B6%E6%9E%84/%E7%89%B9%E6%AE%8A%E5%AF%84%E5%AD%98%E5%99%A8xPSR/">特殊寄存器xPSR</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >RTOS 实时操作系统</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../RTOS/RTOS/">简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../RTOS/%E4%BB%BB%E5%8A%A1%E5%A0%86%E6%A0%88/">任务堆栈</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../RTOS/%E4%BB%BB%E5%8A%A1%E5%88%87%E6%8D%A2/">任务切换</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >FreeRTOS</a>
    <ul>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/FreeRTOS.md">FreeRTOS 简介</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/任务创建和删除.md">任务创建和删除</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/任务调度.md">任务调度</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/任务通知.md">任务通知</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/内存管理.md">内存管理</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/同步、互斥与通信.md">同步、互斥与通信</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/队列.md">队列</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/队列集.md">队列集</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/中断管理.md">中断管理</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../电赛软件/RTOS/FreeRTOS/移植.md">移植</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >STM32 HAL 库</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../STM32%20HAL%E5%BA%93/">库介绍</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../GPIO%E6%93%8D%E4%BD%9C/">GPIO 操作</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../NVIC/">NVIC</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../DMA/">DMA</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">ADC</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#11-adc">1.1 ADC工作原理</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#12">1.2 主要参数</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%AE%9A%E6%97%B6%E5%99%A8/">定时器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../FLASH/">FLASH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../BKP%26RTC/">BKP & RTC</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../WDG/">WDG</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%A1%AC%E4%BB%B6%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/">硬件通信协议</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >通信协议</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/">简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/I2C/">I2C</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/SPI/">SPI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/USART/">USART</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/CAN/">CAN</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >电控算法</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../%E7%94%B5%E6%8E%A7%E7%AE%97%E6%B3%95/%E7%94%B5%E6%8E%A7%E7%AE%97%E6%B3%95/">简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E7%94%B5%E6%8E%A7%E7%AE%97%E6%B3%95/PID/">PID</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E7%94%B5%E6%8E%A7%E7%AE%97%E6%B3%95/LQR/">LQR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E7%94%B5%E6%8E%A7%E7%AE%97%E6%B3%95/SMC/">SMC</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >视觉应用</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../%E8%A7%86%E8%A7%89/%E8%A7%86%E8%A7%89/">视觉</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../%E8%A7%86%E8%A7%89/Micropython%20%26%20K230/">Micropython & K230</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">个人技术与学习笔记</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">电赛软件 (Embedded Software)</li>
          <li class="breadcrumb-item">STM32 HAL 库</li>
      <li class="breadcrumb-item active">ADC</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1-adc">1. ADC基础概念</h1>
<h2 id="11-adc">1.1 ADC工作原理</h2>
<p>模数转换器（ADC）将模拟信号转换为数字信号，STM32的ADC通常是逐次逼近型。</p>
<h2 id="12">1.2 主要参数</h2>
<ul>
<li>
<p><strong>分辨率</strong>: 12位（0-4095）</p>
</li>
<li>
<p><strong>采样时间</strong>: 可配置，影响转换精度</p>
</li>
<li>
<p><strong>参考电压</strong>: VREF+ 和 VREF-</p>
</li>
<li>
<p><strong>转换模式</strong>: 单次、连续、扫描、间断</p>
</li>
</ul>
<h1 id="2">2.配置说明</h1>
<h2 id="11">1.1 步骤</h2>
<ol>
<li>选择通道值</li>
<li>选择ADC1或ADC2</li>
<li>进入对应ADC配置界面进行配置</li>
</ol>
<h2 id="12_1">1.2 参数说明</h2>
<h3 id="_1">工作模式</h3>
<p><img alt="" src="../../%E5%9B%BE%E6%BA%90/ADC%E9%85%8D%E7%BD%AE1.png" /></p>
<h4 id="vs-adc">独立模式 vs 多ADC模式</h4>
<h5 id="independent-mode">独立模式 (Independent mode)</h5>
<ul>
<li><strong>描述</strong>: 单个ADC独立工作，不与其他ADC交互</li>
<li><strong>应用场景</strong>: 简单的单通道或多通道采样需求</li>
<li><strong>配置方法</strong>:</li>
</ul>
<pre><code class="language-c">hadc1.Init.ScanConvMode = DISABLE;  // 单通道
// 或
hadc1.Init.ScanConvMode = ENABLE;   // 多通道扫描
</code></pre>
<h5 id="adc-dual-adc-modes">双ADC组合模式 (Dual ADC modes)</h5>
<h6 id="1-combined-regular-simultaneous-mode">1. 组合规则同步模式 (Combined Regular Simultaneous Mode)</h6>
<ul>
<li><strong>工作原理</strong>: 两个ADC同时采样不同的通道，转换同步进行</li>
<li><strong>优势</strong>: 提高采样吞吐量，同时获取多个信号</li>
<li><strong>典型应用</strong>: 需要同步采样的多路信号</li>
</ul>
<pre><code class="language-c">// ADC1和ADC2同时采样不同通道
// 转换结果分别存储
</code></pre>
<h6 id="2-interleaved-mode">2. 交替模式 (Interleaved Mode)</h6>
<ul>
<li><strong>工作原理</strong>: 两个ADC交替对同一通道进行采样</li>
<li><strong>优势</strong>: 有效提高采样率（几乎翻倍）</li>
<li><strong>时序</strong>: ADC1采样 → ADC1转换 → ADC2采样 → ADC2转换</li>
</ul>
<pre><code class="language-c">// 适用于高频信号采集
// 采样率 = 2 × 单个ADC采样率
</code></pre>
<h6 id="3-alternate-trigger-mode">3. 交替触发模式 (Alternate Trigger Mode)</h6>
<ul>
<li><strong>工作原理</strong>: 使用外部触发信号交替触发两个ADC</li>
<li><strong>优势</strong>: 精确控制采样时序</li>
<li><strong>应用</strong>: 需要严格时序控制的应用</li>
</ul>
<h6 id="4-combined-injected-simultaneous-mode">4. 组合注入同步模式 (Combined Injected Simultaneous Mode)</h6>
<ul>
<li><strong>工作原理</strong>: 两个ADC同步执行注入组转换</li>
<li><strong>优势</strong>: 高优先级信号的同步采集</li>
<li><strong>应用</strong>: 紧急事件处理、关键参数监测</li>
</ul>
<h6 id="5-watchdog-mode">5. 看门狗模式 (Watchdog Mode)</h6>
<ul>
<li><strong>工作原理</strong>: 监控特定ADC通道，当数值超出设定范围时触发中断</li>
<li><strong>配置示例</strong>:</li>
</ul>
<pre><code class="language-c">ADC_AnalogWDGConfTypeDef AnalogWDGConfig;
AnalogWDGConfig.WatchdogNumber = ADC_ANALOGWATCHDOG_1;
AnalogWDGConfig.Channel = ADC_CHANNEL_0;
AnalogWDGConfig.ITMode = ENABLE;
AnalogWDGConfig.HighThreshold = 3000;
AnalogWDGConfig.LowThreshold = 1000;
HAL_ADC_AnalogWDGConfig(&amp;hadc1, &amp;AnalogWDGConfig);
</code></pre>
<h4 id="scan-mode">扫描模式 (Scan Mode)</h4>
<h5 id="_2">单次扫描</h5>
<ul>
<li><strong>行为</strong>: 配置的所有通道按顺序转换一次后停止</li>
<li><strong>配置</strong>:</li>
</ul>
<pre><code class="language-c">hadc1.Init.ScanConvMode = ENABLE;
hadc1.Init.ContinuousConvMode = DISABLE;
</code></pre>
<h5 id="_3">连续扫描</h5>
<ul>
<li><strong>行为</strong>: 配置的所有通道循环连续转换</li>
<li><strong>配置</strong>:</li>
</ul>
<pre><code class="language-c">hadc1.Init.ScanConvMode = ENABLE;
hadc1.Init.ContinuousConvMode = ENABLE;
</code></pre>
<h4 id="_4">转换模式</h4>
<h5 id="single-conversion">单次转换模式 (Single Conversion)</h5>
<ul>
<li><strong>工作流程</strong>: 启动 → 转换指定通道 → 停止</li>
<li><strong>适用场景</strong>: 低速、低功耗应用</li>
</ul>
<pre><code class="language-c">hadc1.Init.ContinuousConvMode = DISABLE;
HAL_ADC_Start(&amp;hadc1);  // 每次都需要重新启动
</code></pre>
<h5 id="continuous-conversion">连续转换模式 (Continuous Conversion)</h5>
<ul>
<li><strong>工作流程</strong>: 启动后自动连续转换，无需重复触发</li>
<li><strong>适用场景</strong>: 高速数据采集</li>
</ul>
<pre><code class="language-c">hadc1.Init.ContinuousConvMode = ENABLE;
HAL_ADC_Start(&amp;hadc1);  // 启动后持续运行
</code></pre>
<h4 id="_5">触发模式</h4>
<h5 id="_6">软件触发</h5>
<ul>
<li><strong>控制方式</strong>: 通过代码控制转换开始</li>
<li><strong>灵活性</strong>: 高，可精确控制采样时刻</li>
</ul>
<pre><code class="language-c">hadc1.Init.ExternalTrigConv = ADC_SOFTWARE_START;
HAL_ADC_Start(&amp;hadc1);  // 软件启动
</code></pre>
<h5 id="_7">硬件触发</h5>
<ul>
<li><strong>触发源</strong>: 定时器、外部引脚等</li>
<li><strong>优势</strong>: 精确的定时采样，不依赖CPU</li>
</ul>
<pre><code class="language-c">// 使用TIM1触发ADC转换
hadc1.Init.ExternalTrigConv = ADC_EXTERNALTRIGCONV_T1_TRGO;
</code></pre>
<h4 id="_8">数据管理模式</h4>
<h5 id="polling">轮询模式 (Polling)</h5>
<pre><code class="language-c">HAL_ADC_Start(&amp;hadc1);
HAL_ADC_PollForConversion(&amp;hadc1, timeout);
value = HAL_ADC_GetValue(&amp;hadc1);
</code></pre>
<h5 id="interrupt">中断模式 (Interrupt)</h5>
<pre><code class="language-c">HAL_ADC_Start_IT(&amp;hadc1);
// 在回调函数中处理数据
void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc)
</code></pre>
<h5 id="dma-direct-memory-access">DMA模式 (Direct Memory Access)</h5>
<ul>
<li><strong>优势</strong>: 不占用CPU，高效处理大量数据</li>
<li><strong>配置</strong>:</li>
</ul>
<pre><code class="language-c">// 单次DMA传输
HAL_ADC_Start_DMA(&amp;hadc1, (uint32_t*)buffer, length);

// 循环DMA传输（需配置DMA为循环模式）
</code></pre>
<h4 id="vs">注入组 vs 规则组</h4>
<h5 id="regular-group">规则组 (Regular Group)</h5>
<ul>
<li><strong>优先级</strong>: 普通</li>
<li><strong>通道数量</strong>: 最多16个通道</li>
<li><strong>触发方式</strong>: 软件或硬件触发</li>
<li><strong>典型应用</strong>: 常规数据采集</li>
</ul>
<h5 id="injected-group">注入组 (Injected Group)</h5>
<ul>
<li><strong>优先级</strong>: 高（可中断规则组转换）</li>
<li><strong>通道数量</strong>: 最多4个通道  </li>
<li><strong>触发方式</strong>: 自动或外部触发</li>
<li><strong>典型应用</strong>: 紧急事件处理、关键参数</li>
</ul>
<pre><code class="language-c">// 配置注入组
ADC_InjectionConfTypeDef sConfigInjected;
sConfigInjected.InjectedNbrOfConversion = 2;
sConfigInjected.InjectedChannel = ADC_CHANNEL_1;
sConfigInjected.InjectedRank = 1;
HAL_ADCEx_InjectedConfigChannel(&amp;hadc1, &amp;sConfigInjected);
</code></pre>
<h4 id="_9">低功耗模式</h4>
<h5 id="auto-delay">自动延迟模式 (Auto-delay)</h5>
<ul>
<li><strong>功能</strong>: 在转换间插入延迟以降低功耗</li>
<li><strong>适用</strong>: 对采样率要求不高的应用</li>
</ul>
<h5 id="discontinuous-mode">间断模式 (Discontinuous Mode)</h5>
<ul>
<li><strong>工作方式</strong>: 每次触发只转换指定数量的通道</li>
<li><strong>节能效果</strong>: 减少不必要的转换操作</li>
</ul>
<h4 id="_10">模式选择指南</h4>
<table>
<thead>
<tr>
<th>应用场景</th>
<th>推荐模式</th>
<th>理由</th>
</tr>
</thead>
<tbody>
<tr>
<td>简单单通道采样</td>
<td>独立模式 + 轮询</td>
<td>实现简单，资源占用少</td>
</tr>
<tr>
<td>高速数据采集</td>
<td>独立模式 + DMA + 连续转换</td>
<td>高吞吐量，CPU占用低</td>
</tr>
<tr>
<td>同步多路信号</td>
<td>组合规则同步模式</td>
<td>同时采集，数据相关性好</td>
</tr>
<tr>
<td>超高频信号</td>
<td>交替模式</td>
<td>有效提升采样率</td>
</tr>
<tr>
<td>关键参数监控</td>
<td>看门狗模式 + 注入组</td>
<td>实时监控，快速响应</td>
</tr>
<tr>
<td>定时精确采样</td>
<td>硬件触发模式</td>
<td>时序精确，不依赖软件</td>
</tr>
</tbody>
</table>
<h4 id="_11">配置注意事项</h4>
<ol>
<li><strong>时钟配置</strong>: 确保ADC时钟不超过器件最大频率</li>
<li><strong>采样时间</strong>: 根据信号源阻抗调整采样时间</li>
<li><strong>DMA配置</strong>: 多ADC模式需要合理配置DMA数据流</li>
<li><strong>中断优先级</strong>: 注入组中断应设置为较高优先级</li>
<li><strong>电源噪声</strong>: 模拟部分供电需要良好的去耦设计</li>
</ol>
<h3 id="_12">基本设置</h3>
<p><img alt="" src="../../%E5%9B%BE%E6%BA%90/ADC%E9%85%8D%E7%BD%AE2.png" /></p>
<h4 id="_13">数据对齐</h4>
<p>左对齐或右对齐</p>
<h4 id="_14">扫描模式</h4>
<p>是否对多通道扫描</p>
<h4 id="_15">连续转换模式</h4>
<p>是否启用连续转换</p>
<h3 id="_16">规则组设置</h3>
<p><img alt="" src="../../%E5%9B%BE%E6%BA%90/ADC%E9%85%8D%E7%BD%AE3.png" />
- <strong>Number Of Conversion:</strong> 每次转换多少通道。若此值大于1，最好配合DMA，因为规则组转换完成存储数据的寄存器只有一个，后来的会覆盖前面的数据。
- <strong>External Trigger Conversion Source:</strong> 选择转换触发源：软件 or 硬件（定时器）
- <strong>Rank&amp;Channel&amp;SampleTIme:</strong> 配置对应通道转换的序号以及采样率[^1]</p>
<p>[^1]: <strong>SampleTime 1.5 Cycles</strong> 指的是ADC对输入信号进行采样的时间长度为<strong>1.5个ADC时钟周期</strong>。</p>
<h3 id="_17">注入组设置&amp;开门狗启用</h3>
<p><img alt="" src="../../%E5%9B%BE%E6%BA%90/ADC%E9%85%8D%E7%BD%AE4.png" /></p>
<h3 id="nvic">中断设置（NVIC）</h3>
<h4 id="_18">中断的基本概念</h4>
<p>ADC全局中断用于在特定ADC事件发生时通知CPU，实现异步事件处理，避免轮询等待。</p>
<h4 id="_19">主要中断事件类型</h4>
<pre><code class="language-c">// ADC常见中断事件
#define ADC_IT_EOC      ((uint32_t)ADC_IER_EOCIE)      // 转换完成中断
#define ADC_IT_JEOC     ((uint32_t)ADC_IER_JEOCIE)     // 注入组转换完成
#define ADC_IT_AWD      ((uint32_t)ADC_IER_AWDIE)      // 模拟看门狗中断
#define ADC_IT_OVR      ((uint32_t)ADC_IER_OVRIE)      // 溢出中断
</code></pre>
<h2 id="_20">用户实现</h2>
<h3 id="_21">自校准</h3>
<p>需要在cubemx生成的adc.c中ADC初始化函数补充(例adc1)</p>
<pre><code class="language-c">/* USER CODE BEGIN ADC1_Init 2 */  
//自校准  
if (HAL_ADCEx_Calibration_Start(&amp;hadc1)!= HAL_OK)  
{  
  Error_Handler();  
}  
/* USER CODE END ADC1_Init 2 */
</code></pre>
<h3 id="adc2">读取特定通道值（独立单次非扫描,adc2）</h3>
<pre><code class="language-c">ADC_ChannelConfTypeDef sConfig = {0};
sConfig.Channel = ADC_CHANNEL_2;//配置对应通道到首位
sConfig.Rank = ADC_REGULAR_RANK_1;  
sConfig.SamplingTime = ADC_SAMPLETIME_1CYCLE_5;  
if (HAL_ADC_ConfigChannel(&amp;hadc2, &amp;sConfig) != HAL_OK)  
{  
  Error_Handler();  
}  
// 启动ADC转换  
if (HAL_ADC_Start(&amp;hadc2) == HAL_OK)  
{  
  // 等待转换完成  
  if (HAL_ADC_PollForConversion(&amp;hadc2, 100) == HAL_OK)  
  {  
    return HAL_ADC_GetValue(&amp;hadc2);  
  }  
}  
Error_Handler();
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../DMA/" class="btn btn-neutral float-left" title="DMA"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../%E5%AE%9A%E6%97%B6%E5%99%A8/" class="btn btn-neutral float-right" title="定时器">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2025 马梓腾</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../DMA/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../%E5%AE%9A%E6%97%B6%E5%99%A8/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
